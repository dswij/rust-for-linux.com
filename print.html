<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rust for Linux</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="Adding support for the Rust language to the Linux kernel">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        
        <link rel="icon" href="Rust-for-Linux.svg">

        <meta property="og:url" content="https://rust-for-linux.com">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Rust for Linux">
        <meta property="og:description" content="Adding support for the Rust language to the Linux kernel">
        <meta property="og:image" content="https://rust-for-linux.com/Rust-for-Linux.svg">
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "CreativeWork",
            "name": "Rust for Linux",
            "description": "Adding support for the Rust language to the Linux kernel",
            "url": "https://rust-for-linux.com",
            "image": "https://rust-for-linux.com/Rust-for-Linux.svg"
        }
        </script>
        <style>
        #logo {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .rfl-menu-block {
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .rfl-mono-font {
            font-family: var(--mono-font);
        }

        .rfl-mobile-links {
            display: none;
        }

        @media only screen and (max-width: 1080px) {
            .rfl-mobile-links {
                display: block;
            }
        }

        .chapter li.chapter-item {
            margin-top: 0.2em !important;
            margin-left: 1.5em !important;
        }

        .chapter li.part-title {
            margin-bottom: -0.3em !important;
            margin-top: 1em !important;
        }

        .quote-highlight:target {
            /*
             * `--table-header-bg` is used as an existing color in the themes
             * that is good enough for highlighting the `blockquote`s.
             */
            background-color: var(--table-header-bg);
        }
        </style>
    
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
        <div class="sidebar-scrollbox">
            <a href="/"><img id="logo" src="Rust-for-Linux.svg" alt="Rust for Linux Logo"></a>
            
            <p class="rfl-menu-block">The project</p>
            <ol class="chapter"><li class="chapter-item"><a href="Contact.html" tabindex="0">Contact</a></li><li class="chapter-item"><a href="Contributing.html" tabindex="0">Contributing</a></li><li class="chapter-item"><a href="Branches.html" tabindex="0">Branches</a></li><li class="chapter-item"><a href="Rust-version-policy.html" tabindex="0">Rust version policy</a></li><li class="chapter-item"><a href="Unstable-features.html" tabindex="0">Unstable features</a></li><li class="chapter-item"><a href="Backporting-and-stable-LTS-releases.html" tabindex="0">Backporting and stable/LTS releases</a></li><li class="chapter-item"><a href="Third-party-crates.html" tabindex="0">Third-party crates</a></li><li class="chapter-item"><a href="Out-of-tree-modules.html" tabindex="0">Out-of-tree modules</a></li><li class="chapter-item"><a href="Industry-and-academia-support.html" tabindex="0">Industry and academia support</a></li><li class="chapter-item"><a href="Sponsors.html" tabindex="0">Sponsors</a></li><li class="part-title">Subprojects</li><li class="chapter-item"><a href="klint.html" tabindex="0"><span class="rfl-mono-font">klint</span></a></li><li class="chapter-item"><a href="pinned-init.html" tabindex="0"><span class="rfl-mono-font">pinned-init</span></a></li><li class="part-title">Tools</li><li class="chapter-item"><a href="Coccinelle-for-Rust.html" tabindex="0">Coccinelle for Rust</a></li><li class="chapter-item"><a href="rustc_codegen_gcc.html" tabindex="0"><span class="rfl-mono-font">rustc_codegen_gcc</span></a></li><li class="part-title">Users</li><li class="chapter-item"><a href="NVMe-driver.html" tabindex="0">NVMe Driver</a></li><li class="chapter-item"><a href="Null-Block-Driver.html" tabindex="0">Null Block Driver</a></li><li class="chapter-item"><a href="Android-Binder-Driver.html" tabindex="0">Android Binder Driver</a></li><li class="chapter-item"><a href="PuzzleFS-filesystem-driver.html" tabindex="0">PuzzleFS filesystem driver</a></li><li class="chapter-item"><a href="Apple-AGX-GPU-driver.html" tabindex="0">Apple AGX GPU driver</a></li></ol>
        
            <p class="rfl-menu-block">Links</p>
            <ol class="chapter"><li class="part-title">Contact</li><li class="chapter-item"><a href="https://lore.kernel.org/rust-for-linux/" tabindex="0">Lore (mailing list archive)</a></li><li class="chapter-item"><a href="https://rust-for-linux.zulipchat.com" tabindex="0">Zulip (chat)</a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux" tabindex="0">GitHub Organization</a></li><li class="part-title">Security</li><li class="chapter-item"><a href="https://docs.kernel.org/process/security-bugs.html" tabindex="0">Report a security bug</a></li><li class="part-title">Issue tracking</li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/issues" tabindex="0">Issues</a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/issues/2" tabindex="0">Unstable features</a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/contribute" tabindex="0">Good first issues</a></li><li class="part-title">Branches</li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/tree/rust-next" tabindex="0"><span class="rfl-mono-font">rust-next</span></a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/tree/rust-fixes" tabindex="0"><span class="rfl-mono-font">rust-fixes</span></a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/linux/tree/rust-dev" tabindex="0"><span class="rfl-mono-font">rust-dev</span></a></li><li class="part-title">Documentation</li><li class="chapter-item"><a href="https://docs.kernel.org/rust/" tabindex="0">Kernel documentation (mainline)</a></li><li class="chapter-item"><a href="https://docs.kernel.org/next/rust/" tabindex="0">Kernel documentation (next)</a></li><li class="chapter-item"><a href="https://rust-for-linux.github.io/docs/v6.6-rc2/kernel/" tabindex="0"><span class="rfl-mono-font">rustdoc</span> code docs (v6.6-rc2)</a></li><li class="chapter-item"><a href="https://rust-for-linux.github.io/docs/rust/kernel/" tabindex="0"><span class="rfl-mono-font">rustdoc</span> code docs (<span class="rfl-mono-font">rust</span> 2023-03-13)</a></li><li class="chapter-item"><a href="https://github.com/Rust-for-Linux/rust-out-of-tree-module" tabindex="0">Out-of-tree module template</a></li><li class="part-title">Conferences</li><li class="chapter-item"><a href="https://kangrejos.com" tabindex="0">Kangrejos</a></li><li class="chapter-item"><a href="https://lpc.events" tabindex="0">Linux Plumbers Conference (LPC)</a></li><li class="chapter-item"><a href="https://lpc.events/event/17/sessions/170/" tabindex="0">Rust MC at LPC 2023</a></li><li class="chapter-item"><a href="https://lpc.events/event/16/sessions/150/" tabindex="0">Rust MC at LPC 2022</a></li><li class="part-title">LWN</li><li class="chapter-item"><a href="https://lwn.net/Kernel/Index/#Development_tools-Rust" tabindex="0">Rust index</a></li><li class="chapter-item"><a href="https://lwn.net/Archives/ConferenceIndex/#Kangrejos" tabindex="0">Kangrejos index</a></li><li class="part-title">Toolchain projects</li><li class="chapter-item"><a href="https://github.com/rust-lang/rustc_codegen_gcc" tabindex="0"><span class="rfl-mono-font">rustc_codegen_gcc</span></a></li><li class="chapter-item"><a href="https://rust-gcc.github.io" tabindex="0">Rust GCC</a></li><li class="part-title">Other trees</li><li class="chapter-item"><a href="https://git.kernel.org/linus/" tabindex="0">Linus' tree</a></li><li class="chapter-item"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/" tabindex="0">Stable tree</a></li><li class="chapter-item"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/" tabindex="0"><span class="rfl-mono-font">linux-next</span> tree</a></li><li class="part-title">Other resources</li><li class="chapter-item"><a href="https://elixir.bootlin.com/linux/latest/source/rust" tabindex="0">Bootlin's Elixir</a></li><li class="chapter-item"><a href="https://godbolt.org/z/a55MozK6s" tabindex="0">Compiler Explorer</a></li><li class="chapter-item"><a href="https://play.rust-lang.org/?version=nightly&mode=debug&edition=2021" tabindex="0">Rust Playground</a></li><li class="chapter-item"><a href="https://doc.rust-lang.org/core/" tabindex="0">Rust <span class="rfl-mono-font">core</span> docs</a></li></ol>
        
        </div>
    
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust for Linux</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Rust-for-Linux/rust-for-linux.com" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rust-for-linux"><a class="header" href="#rust-for-linux">Rust for Linux</a></h1>
<p>Rust for Linux is the project adding support for the Rust language to the Linux kernel.</p>
<p>This website is intended as a hub of links, documentation and resources related to the project.</p>
<a href="sponsors">
    <div style="background: white; margin-top: 2.5em; border-radius: 10px; padding: 20px; display: flex; align-items: center; justify-content: center; column-gap: 4%;">
        <div style="flex: 14 1 0;"><img style="width: 100%; height: auto;" src="ISRG.svg" alt="ISRG Logo"></div>
        <div style="flex: 15 1 0;"><img style="width: 100%; height: auto;" src="Google.svg" alt="Google Logo"></div>
        <div style="flex:  9 1 0;"><img style="width: 100%; height: auto;" src="Futurewei.png" alt="Futurewei Logo"></div>
    </div>
</a>

        <h2><a class="header" href="#the-project">The project</a></h2>
        <ul><li><a href="Contact.html" tabindex="0">Contact</a></li><li><a href="Contributing.html" tabindex="0">Contributing</a></li><li><a href="Branches.html" tabindex="0">Branches</a></li><li><a href="Rust-version-policy.html" tabindex="0">Rust version policy</a></li><li><a href="Unstable-features.html" tabindex="0">Unstable features</a></li><li><a href="Backporting-and-stable-LTS-releases.html" tabindex="0">Backporting and stable/LTS releases</a></li><li><a href="Third-party-crates.html" tabindex="0">Third-party crates</a></li><li><a href="Out-of-tree-modules.html" tabindex="0">Out-of-tree modules</a></li><li><a href="Industry-and-academia-support.html" tabindex="0">Industry and academia support</a></li><li><a href="Sponsors.html" tabindex="0">Sponsors</a></li></ul>
<h3>Subprojects</h3>
<ul><li><a href="klint.html" tabindex="0"><span class="rfl-mono-font">klint</span></a></li><li><a href="pinned-init.html" tabindex="0"><span class="rfl-mono-font">pinned-init</span></a></li></ul>
<h3>Tools</h3>
<ul><li><a href="Coccinelle-for-Rust.html" tabindex="0">Coccinelle for Rust</a></li><li><a href="rustc_codegen_gcc.html" tabindex="0"><span class="rfl-mono-font">rustc_codegen_gcc</span></a></li></ul>
<h3>Users</h3>
<ul><li><a href="NVMe-driver.html" tabindex="0">NVMe Driver</a></li><li><a href="Null-Block-Driver.html" tabindex="0">Null Block Driver</a></li><li><a href="Android-Binder-Driver.html" tabindex="0">Android Binder Driver</a></li><li><a href="PuzzleFS-filesystem-driver.html" tabindex="0">PuzzleFS filesystem driver</a></li><li><a href="Apple-AGX-GPU-driver.html" tabindex="0">Apple AGX GPU driver</a></li></ul>

        <div class="rfl-mobile-links">
            <h2><a class="header" href="#links">Links</a></h2>
            <h3>Contact</h3>
<ul><li><a href="https://lore.kernel.org/rust-for-linux/" tabindex="0">Lore (mailing list archive)</a></li><li><a href="https://rust-for-linux.zulipchat.com" tabindex="0">Zulip (chat)</a></li><li><a href="https://github.com/Rust-for-Linux" tabindex="0">GitHub Organization</a></li></ul>
<h3>Security</h3>
<ul><li><a href="https://docs.kernel.org/process/security-bugs.html" tabindex="0">Report a security bug</a></li></ul>
<h3>Issue tracking</h3>
<ul><li><a href="https://github.com/Rust-for-Linux/linux/issues" tabindex="0">Issues</a></li><li><a href="https://github.com/Rust-for-Linux/linux/issues/2" tabindex="0">Unstable features</a></li><li><a href="https://github.com/Rust-for-Linux/linux/contribute" tabindex="0">Good first issues</a></li></ul>
<h3>Branches</h3>
<ul><li><a href="https://github.com/Rust-for-Linux/linux/tree/rust-next" tabindex="0"><span class="rfl-mono-font">rust-next</span></a></li><li><a href="https://github.com/Rust-for-Linux/linux/tree/rust-fixes" tabindex="0"><span class="rfl-mono-font">rust-fixes</span></a></li><li><a href="https://github.com/Rust-for-Linux/linux/tree/rust-dev" tabindex="0"><span class="rfl-mono-font">rust-dev</span></a></li></ul>
<h3>Documentation</h3>
<ul><li><a href="https://docs.kernel.org/rust/" tabindex="0">Kernel documentation (mainline)</a></li><li><a href="https://docs.kernel.org/next/rust/" tabindex="0">Kernel documentation (next)</a></li><li><a href="https://rust-for-linux.github.io/docs/v6.6-rc2/kernel/" tabindex="0"><span class="rfl-mono-font">rustdoc</span> code docs (v6.6-rc2)</a></li><li><a href="https://rust-for-linux.github.io/docs/rust/kernel/" tabindex="0"><span class="rfl-mono-font">rustdoc</span> code docs (<span class="rfl-mono-font">rust</span> 2023-03-13)</a></li><li><a href="https://github.com/Rust-for-Linux/rust-out-of-tree-module" tabindex="0">Out-of-tree module template</a></li></ul>
<h3>Conferences</h3>
<ul><li><a href="https://kangrejos.com" tabindex="0">Kangrejos</a></li><li><a href="https://lpc.events" tabindex="0">Linux Plumbers Conference (LPC)</a></li><li><a href="https://lpc.events/event/17/sessions/170/" tabindex="0">Rust MC at LPC 2023</a></li><li><a href="https://lpc.events/event/16/sessions/150/" tabindex="0">Rust MC at LPC 2022</a></li></ul>
<h3>LWN</h3>
<ul><li><a href="https://lwn.net/Kernel/Index/#Development_tools-Rust" tabindex="0">Rust index</a></li><li><a href="https://lwn.net/Archives/ConferenceIndex/#Kangrejos" tabindex="0">Kangrejos index</a></li></ul>
<h3>Toolchain projects</h3>
<ul><li><a href="https://github.com/rust-lang/rustc_codegen_gcc" tabindex="0"><span class="rfl-mono-font">rustc_codegen_gcc</span></a></li><li><a href="https://rust-gcc.github.io" tabindex="0">Rust GCC</a></li></ul>
<h3>Other trees</h3>
<ul><li><a href="https://git.kernel.org/linus/" tabindex="0">Linus' tree</a></li><li><a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/" tabindex="0">Stable tree</a></li><li><a href="https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/" tabindex="0"><span class="rfl-mono-font">linux-next</span> tree</a></li></ul>
<h3>Other resources</h3>
<ul><li><a href="https://elixir.bootlin.com/linux/latest/source/rust" tabindex="0">Bootlin's Elixir</a></li><li><a href="https://godbolt.org/z/a55MozK6s" tabindex="0">Compiler Explorer</a></li><li><a href="https://play.rust-lang.org/?version=nightly&mode=debug&edition=2021" tabindex="0">Rust Playground</a></li><li><a href="https://doc.rust-lang.org/core/" tabindex="0">Rust <span class="rfl-mono-font">core</span> docs</a></li></ul>

        </div>
    
<div style="break-before: page; page-break-before: always;"></div><h1 id="contact"><a class="header" href="#contact">Contact</a></h1>
<h2 id="mailing-list"><a class="header" href="#mailing-list">Mailing list</a></h2>
<p>The <a href="mailto:rust-for-linux@vger.kernel.org"><code>rust-for-linux@vger.kernel.org</code></a> mailing list is primarily meant for patch submission and reviewing, as well as announcements and technical discussions on mainline development:</p>
<ul>
<li><a href="mailto:rust-for-linux+subscribe@vger.kernel.org">Subscription link</a>.</li>
<li><a href="https://subspace.kernel.org/subscribing.html">Subscription instructions</a>.</li>
<li><a href="https://lore.kernel.org/rust-for-linux/">Lore (archive)</a>.</li>
</ul>
<p>Please read the <a href="https://subspace.kernel.org/etiquette.html">Mailing list etiquette</a> document if it is the first time you send an email to a Linux kernel mailing list.</p>
<p>For general questions, please use the Zulip chat instead.</p>
<h2 id="zulip-chat"><a class="header" href="#zulip-chat">Zulip chat</a></h2>
<p>For chat, we use <a href="https://rust-for-linux.zulipchat.com">Zulip</a>.</p>
<ul>
<li><a href="https://rust-for-linux.zulipchat.com/register/">Registration link</a>.</li>
</ul>
<p>Please feel free to use it for general questions, discussion, help, feedback, etc.</p>
<h2 id="open-meeting"><a class="header" href="#open-meeting">Open Meeting</a></h2>
<p>Everybody is welcome to join our <a href="https://meet.google.com/vii-meij-xpw">Open Meeting</a>.</p>
<p>It takes place once every kernel cycle, the first Wednesday after <code>-rc1</code> is tagged, at 18:00 UTC.</p>
<h2 id="github-issue-tracker"><a class="header" href="#github-issue-tracker">GitHub issue tracker</a></h2>
<p><a href="https://github.com/Rust-for-Linux/linux/issues">GitHub</a> is used for issue reporting, tracking and discussion.</p>
<ul>
<li><a href="https://github.com/Rust-for-Linux/linux/issues/new/choose">Submit a new issue</a>.</li>
<li><a href="https://github.com/Rust-for-Linux/linux/issues/2">Unstable features list</a>.</li>
<li><a href="https://github.com/Rust-for-Linux/linux/contribute">Good first issues</a>.</li>
</ul>
<p>Please do <em><strong>not</strong></em> report security bugs in the GitHub issue tracker. Instead, please read the <a href="https://docs.kernel.org/admin-guide/security-bugs.html">Security bugs</a> page in the kernel documentation.</p>
<h2 id="email"><a class="header" href="#email">Email</a></h2>
<p>For other matters, please feel free to contact the <a href="https://docs.kernel.org/process/maintainers.html#rust">maintainers</a> via email.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>There are many ways to contribute to Rust for Linux. One way is to contribute to the kernel itself — the rest of this page focuses on that. But there are other ways as well:</p>
<ul>
<li>
<p>In Rust:</p>
<ul>
<li>
<p>Helping to stabilize <a href="Unstable-features.html">unstable features</a> the kernel requires.</p>
</li>
<li>
<p>Adding support for features we would like in the kernel: in the language, in the standard library, in the compiler, in <code>rustdoc</code>, in Clippy, in <code>bindgen</code>... Please see the various <a href="https://github.com/Rust-for-Linux/linux/issues/2">&quot;wanted features &amp; bugfixes&quot; lists</a> for each topic.</p>
</li>
</ul>
</li>
<li>
<p>Contributing to the subprojects: <a href="klint.html"><code>klint</code></a> and <a href="pinned-init.html"><code>pinned-init</code></a>.</p>
</li>
<li>
<p>Contributing to the <a href="Coccinelle-for-Rust.html">Coccinelle for Rust</a> project.</p>
</li>
<li>
<p>Contributing to the <a href="rustc_codegen_gcc.html"><code>rustc_codegen_gcc</code></a> project, which will be used by the kernel for GCC builds.</p>
</li>
<li>
<p>Contributing to the <a href="https://rust-gcc.github.io">GCC Rust</a> project, which eventually will provide a second toolchain for GCC builds.</p>
</li>
</ul>
<h2 id="the-kernel-development-process"><a class="header" href="#the-kernel-development-process">The kernel development process</a></h2>
<p>The Rust support is part of the Linux kernel, and thus contributing works the same way as for the latter. That implies, among other things:</p>
<ul>
<li>
<p>A patch-based workflow is used.</p>
</li>
<li>
<p>Reviews take place in the different mailing lists of the kernel.</p>
</li>
<li>
<p>Contributions are signed under the <a href="https://docs.kernel.org/process/submitting-patches.html#developer-s-certificate-of-origin-1-1">Developer's Certificate of Origin</a>.</p>
</li>
</ul>
<p>To learn more about the kernel development process, please read the documentation under <a href="https://docs.kernel.org/process/index.html"><code>Documentation/process</code></a>. In particular, please make sure to read <a href="https://docs.kernel.org/process/submitting-patches.html"><code>submitting-patches.rst</code></a>.</p>
<p>In addition, it may be a good idea to contribute a small cleanup or fix somewhere in the kernel (not necessarily to Rust code), in order to get accustomed to the patch-based workflow. From time to time we add <a href="https://github.com/Rust-for-Linux/linux/contribute">&quot;good first issues&quot;</a> to our GitHub issue tracker for that purpose.</p>
<h2 id="ways-to-contribute"><a class="header" href="#ways-to-contribute">Ways to contribute</a></h2>
<p>There are many ways to contribute to the Rust support in the kernel:</p>
<ul>
<li>
<p>Submitting changes, of course, whether it is new code or improvements to existing code. Please see the details below on this option.</p>
</li>
<li>
<p>Reviewing patches, especially if you have experience with unsafe Rust and have an eye to spot unsoundness issues or with Rust API design in general. Reviewers can get credited within commits messages via the <code>Reviewed-by</code> tag.</p>
</li>
<li>
<p>Testing patches. Like reviewing, running meaningful testing increases the confidence that the patch is OK. Testers can get credited within commits messages via the <code>Tested-by</code> tag.</p>
</li>
<li>
<p>Reporting issues you find. Reporters can get credited within commits messages via the <code>Reported-by</code> tag.</p>
</li>
<li>
<p>Suggesting improvements. Good ideas that end up being implemented can get credited within commit messages via the <code>Suggested-by</code> tag.</p>
</li>
<li>
<p>Helping others on Zulip. For instance, getting them started with the Rust support in the kernel.</p>
</li>
</ul>
<h2 id="the-rust-subsystem"><a class="header" href="#the-rust-subsystem">The Rust subsystem</a></h2>
<p>The Rust subsystem takes care of the core Rust abstractions as well as the general infrastructure for Rust in the kernel. It is a bit special in that it potentially intersects with every other subsystem in the kernel, especially in the beginning of the Rust support in the kernel.</p>
<p>For this reason, early on, there are a few extra notes to have in mind when contributing Rust code to the kernel.</p>
<h3 id="submitting-changes-to-existing-code"><a class="header" href="#submitting-changes-to-existing-code">Submitting changes to existing code</a></h3>
<p>All patches containing Rust code should be sent to both the maintainers/reviewers/mailing lists of the relevant kernel subsystem they touch as well as the Rust one.</p>
<p>This applies even if the files that the patch modifies are all under <code>rust/</code> (e.g. currently all abstractions live under <code>rust/</code>, but the plan is to change this in the future as Rust grows in the kernel) and the files are referenced by the <code>MAINTAINERS</code> entry of the relevant subsystem. Scripts like <code>scripts/get_maintainers.pl</code> may not provide the complete list.</p>
<p>The goal with this procedure is that everybody interested in Rust can follow what is going on with Rust in the entire kernel in the early stages, to avoid duplicate work, and to make it easier for everybody to coordinate.</p>
<p>For instance, if a patch modifies <code>rust/kernel/time.rs</code>, then the patch should be sent to both &quot;TIMEKEEPING&quot; and &quot;RUST&quot;.</p>
<p>Ideally, the maintainers of the particular subsystem will take the changes through their tree, instead of going through the Rust one.</p>
<p>Please make sure your code is properly documented, that the code compiles warning-free under <code>CLIPPY=1</code>, that the code documentation tests pass and that the code is formatted.</p>
<h3 id="submitting-new-abstractions-and-modules"><a class="header" href="#submitting-new-abstractions-and-modules">Submitting new abstractions and modules</a></h3>
<p>For new abstractions and modules, and especially for those that require new kernel subsystems/maintainers to be involved, please follow the approach outlined here.</p>
<ul>
<li>
<p>Kernel maintainers and developers interested in using Rust should take the lead in developing missing abstractions/modules for the subsystems they need.</p>
</li>
<li>
<p>Part of the work may be already done or in the process of being upstreamed, thus please first check the <a href="https://lore.kernel.org/rust-for-linux/">mailing list archive</a> as well as the <a href="https://github.com/Rust-for-Linux/linux/pulls">PRs submitted to GitHub</a>. It is also a good idea to ask on our <a href="https://rust-for-linux.zulipchat.com">Zulip chat</a>.</p>
</li>
<li>
<p>As early as possible, please get in touch with the maintainers of the relevant subsystem in order to make them aware of the work you are doing or planning to do. That way, they can give you input and feedback on the process. Please feel free to Cc the Rust maintainers too.</p>
</li>
<li>
<p>When you are getting closer to patch submission, please consider sending an RFC series first, especially if it is a major contribution, or if it is a long patch series, or if you require a lot of prerequisite patches (e.g. for abstractions of other subsystems) that are not yet upstreamed.</p>
<p>The RFC can be based on top of a branch placed somewhere else that contains the prerequisite patches, so that the RFC patches themselves do not cover those, and therefore is focused on the parts that the maintainers will eventually review.</p>
<p>This way, you can get early design feedback before the actual patch submission later, and the discussion is focused on the given subsystem (rather than the prerequisites).</p>
</li>
<li>
<p>In general, the kernel does not allow to integrate code without users, but exceptions can potentially be made for Rust code to simplify the upstreaming process early on. That is, upstreaming some dependencies first so that it is easier to upstream expected in-tree users later on. However, note that this is not meant to be a way to justify upstreaming APIs that do not have agreed upon in-tree users. In particular, <a href="Out-of-tree-modules.html">out-of-tree modules</a> do not constitute a user in this context.</p>
<p>Please contact the Rust maintainers for help, especially if you find yourself with a lot of dependencies or patches for unrelated subsystems.</p>
</li>
</ul>
<h2 id="submitting-patches"><a class="header" href="#submitting-patches">Submitting patches</a></h2>
<p>If you are using a CLI tool like <a href="https://git-scm.com/docs/git-send-email"><code>git-send-email</code></a> or <a href="https://b4.docs.kernel.org"><code>b4</code></a>, then you may find the following commands useful for generating the options needed for submitting patches to the Rust subsystem:</p>
<pre><code class="language-sh">awk '/^RUST$/,/^$/' MAINTAINERS | grep '^M:'    | cut -f2- | xargs -IP echo --to \'P\' \\
awk '/^RUST$/,/^$/' MAINTAINERS | grep '^[RL]:' | cut -f2- | xargs -IP echo --cc \'P\' \\
</code></pre>
<p>This list includes the maintainers (<code>M:</code>), reviewers (<code>R:</code>) and mailing list (<code>L:</code>) of the <a href="https://docs.kernel.org/process/maintainers.html#rust">&quot;RUST&quot; subsystem</a> in the <code>MAINTAINERS</code> file.</p>
<p>However, please keep in mind that this does not cover additional subsystems that you may need to submit your patches to, as explained in the other sections.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="branches"><a class="header" href="#branches">Branches</a></h1>
<p>Currently we maintain the following branches.</p>
<h2 id="rust-next"><a class="header" href="#rust-next"><code>rust-next</code></a></h2>
<p><a href="https://github.com/Rust-for-Linux/linux/tree/rust-next"><code>rust-next</code></a> is the branch that contains new Rust features to be submitted during the next merge window of the Linux kernel.</p>
<p>Changes to this branch land via patches sent to the mailing list.</p>
<p>It is part of <a href="https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/"><code>linux-next</code></a>.</p>
<h2 id="rust-fixes"><a class="header" href="#rust-fixes"><code>rust-fixes</code></a></h2>
<p><a href="https://github.com/Rust-for-Linux/linux/tree/rust-fixes"><code>rust-fixes</code></a> is the branch that contains Rust fixes for the current cycle of the Linux kernel.</p>
<p>Changes to this branch land via patches sent to the mailing list.</p>
<p>It is part of <a href="https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/"><code>linux-next</code></a>.</p>
<h2 id="rust-dev"><a class="header" href="#rust-dev"><code>rust-dev</code></a></h2>
<p><a href="https://github.com/Rust-for-Linux/linux/tree/rust-dev"><code>rust-dev</code></a> is an experimental branch for integration purposes. It is a queue for patches that &quot;look good enough&quot;.</p>
<p>Its intended use cases are:</p>
<ul>
<li>Finding merge/apply conflicts as early as possible.</li>
<li>Providing a common base for development that requires features that are not yet in mainline or <code>rust-next</code>, i.e. giving early access to features. This may include Rust-related changes from other subsystems.</li>
<li>Providing extra testing to patches by making them easily available to more developers.</li>
</ul>
<p>Note that this branch may be updated/rebased frequently and it might be gone in the future.</p>
<h2 id="rust"><a class="header" href="#rust"><code>rust</code></a></h2>
<p><a href="https://github.com/Rust-for-Linux/linux/tree/rust"><code>rust</code></a> was the original branch where development happened for two years before Rust support was merged into the kernel.</p>
<p>It contains most of the abstractions that the project worked on as a prototype/showcase. Some of those will eventually land upstream, others may be reworked with feedback from upstream, and a few may be dropped if unneeded.</p>
<p>The branch is now effectively frozen, and generally the only changes that are merged into it are intended to minimize the difference with respect to mainline. When the diff is small enough, the branch will be archived/removed. Until then, the branch is useful to see what is left to upstream, and for some downstream projects to base their work on top.</p>
<p>However, please feel free to submit new PRs for this branch. This is useful so that others are aware of <a href="Contributing.html">what you are working on</a>. Even if you cannot submit a PR, please consider <a href="Contact.html">telling us</a> about it.</p>
<p>Changes to this branch land via <a href="https://github.com/Rust-for-Linux/linux/pulls">GitHub PRs</a>. GitHub Actions is used as a pre-merge CI, compiling the kernel and booting it under QEMU for different toolchains, architectures and configurations. It also checks that some tests passed (e.g. loading sample modules, KUnit tests...) as well as building the PR under Clippy, building the docs, checking <code>rustfmt</code>, etc. <a href="https://linux.kernelci.org/job/rust-for-linux/branch/rust/">KernelCI</a> tests it. Finally, in the past, the <a href="Ksquirrel.html">Ksquirrel</a> bot checked the PRs sent to it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-version-policy"><a class="header" href="#rust-version-policy">Rust version policy</a></h1>
<h2 id="supported-versions"><a class="header" href="#supported-versions">Supported versions</a></h2>
<p>The kernel documents the <a href="https://docs.kernel.org/process/changes.html">minimal requirements</a> to compile it. In the case of Rust, currently only a single version is supported (i.e. rather than a minimum):</p>
<blockquote>
<p>A particular version of the Rust toolchain is required. Newer versions may or may not work because the kernel depends on some unstable Rust features, for the moment.</p>
</blockquote>
<p>The reason is that we cannot guarantee newer Rust versions will work due to the <a href="Unstable-features.html">unstable features</a> in use<sup class="footnote-reference"><a href="#rust-is-stable">1</a></sup>. Removing the need for them is a priority in order to be able to eventually declare a minimum Rust version for the kernel.</p>
<p>Having said that, generally speaking, newer versions should work, as long as one patches any potential compilation errors coming from changes in unstable features.</p>
<div class="footnote-definition" id="rust-is-stable"><sup class="footnote-definition-label">1</sup>
<p>Note that the Rust language is stable, i.e. it promises backwards compatibility. See the <a href="Unstable-features.html">Unstable features</a> page for details.</p>
</div>
<h3 id="distribution-toolchains"><a class="header" href="#distribution-toolchains">Distribution toolchains</a></h3>
<p>Some Linux distributions provide Rust toolchains (i.e. built by the distribution maintainers, rather than redistributing the ones from <a href="https://www.rust-lang.org">rust-lang.org</a>). These toolchains should be fine to use, as long as they have not been modified in unexpected ways (and keeping in mind the versioning limitations).</p>
<h2 id="update-policy"><a class="header" href="#update-policy">Update policy</a></h2>
<h3 id="before-a-minimum-version-can-be-declared"><a class="header" href="#before-a-minimum-version-can-be-declared">Before a minimum version can be declared</a></h3>
<p>It remains to be decided how often the Rust version upgrades will land. Currently, we are tracking the latest Rust release as closely as possible, but it remains to be seen how other kernel developers feel about it.</p>
<p>On top of that, if the <a href="klint.html"><code>klint</code></a> support is merged and starts to be routinely used, then we will also need to be mindful of its schedule.</p>
<h3 id="after-a-minimum-version-is-declared"><a class="header" href="#after-a-minimum-version-is-declared">After a minimum version is declared</a></h3>
<p>If we follow a similar model to the GCC and LLVM support in the kernel (which is likely), then we will not track the latest Rust release (i.e. as a minimum), though how wide the window will be remains to be seen. It is possible we may start with a small window and then widen it, similar to what was originally decided for the LLVM support in the kernel.</p>
<h2 id="submitting-upgrades"><a class="header" href="#submitting-upgrades">Submitting upgrades</a></h2>
<p>Please do not submit patches to upgrade the Rust version. If you want to discuss upgrading the Rust version in the kernel, then please <a href="Contact.html">contact us</a>.</p>
<h2 id="feedback"><a class="header" href="#feedback">Feedback</a></h2>
<p>We are looking for <a href="Contact.html">feedback</a> from Linux distributions, companies and other users and maintainers of downstream kernel releases.</p>
<p>In particular, it would be useful to know:</p>
<ul>
<li>
<p>What versions/policy would work best your distribution/company.</p>
</li>
<li>
<p>If the kernel cannot satisfy exactly that (which is likely, given the current constraints), whether you would prefer to maintain a given compiler version for a while or to backport support from a newer version from mainline.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unstable-features"><a class="header" href="#unstable-features">Unstable features</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>The Rust language is stable, i.e. it promises <a href="https://blog.rust-lang.org/2014/10/30/Stability.html">backwards compatibility</a> within the same <a href="https://doc.rust-lang.org/edition-guide/editions/">edition</a>, with a few exceptions, such as reserving the right to patch safety holes. The kernel currently uses Edition 2021, which is the latest.</p>
<p>On top of that, the kernel uses some Rust unstable features. These features can only be accessed by opting into them. They are typically used as a way to introduce new features into the language, library and toolchain to allow end users to experiment with them and provide feedback before committing to them.</p>
<p>&quot;Unstable&quot; in this context means the feature may change in future versions, i.e. backwards compatibility is not promised for those features. It does not imply that the features are broken. For instance, unstable features may be production-ready and ready for stabilization or they may be experimental, incomplete or internal to the compiler.</p>
<p>When unstable features are deemed mature enough, they may get promoted into stable Rust. In other cases, they may get dropped altogether. Some features are internal to the compiler or perma-unstable.</p>
<p>There are ongoing discussions around stability within the Rust project, such as potentially defining <a href="https://smallcultfollowing.com/babysteps/blog/2023/09/18/stability-without-stressing-the-out/">extra phases</a>. These finer-grained levels could be useful for the kernel.</p>
<h2 id="usage-in-the-kernel"><a class="header" href="#usage-in-the-kernel">Usage in the kernel</a></h2>
<p>The unstable features used in the kernel are tracked at <a href="https://github.com/Rust-for-Linux/linux/issues/2">issue #2</a>.</p>
<p>Removing the need for these is a priority in order to be able to eventually declare a <a href="Rust-version-policy.html">minimum Rust version for the kernel</a>.</p>
<p>Therefore, the set of unstable features used in the kernel needs to be carefully considered. Typically, for each of them, we need to consider:</p>
<ul>
<li>
<p>Whether there is no other way around the issue they help with, or whether the alternative is considered to have bigger downsides than using the unstable feature.</p>
</li>
<li>
<p>Whether they would be required to build the kernel.</p>
</li>
<li>
<p>Whether stabilization is likely, whether they are internal to the compiler and whether they are used in the standard library.</p>
</li>
<li>
<p>Whether other features that are on the critical path will likely take longer to get stabilized anyway.</p>
</li>
</ul>
<p>Moreover, most of the features are only allowed within the <code>kernel</code> crate, i.e. for abstractions. Elsewhere (e.g. drivers), only a minimal set is allowed (see the <code>rust_allowed_features</code> variable in <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/scripts/Makefile.build"><code>scripts/Makefile.build</code></a>).</p>
<p>If you would like to use a new Rust unstable feature in the kernel, then please <a href="Contact.html">contact us</a>.</p>
<h3 id="alloc"><a class="header" href="#alloc"><code>alloc</code></a></h3>
<p><a href="https://doc.rust-lang.org/alloc/"><code>alloc</code></a> is part of the Rust standard library and its implementation uses many unstable features. Normally, this library (as well as <a href="https://doc.rust-lang.org/core/"><code>core</code></a> and others) is provided by the compiler, and thus those unstable features do not break users' code.</p>
<p>Currently, the kernel contains a fork of <code>alloc</code> (matched to the supported Rust version by the kernel) with some additions on top. This complicates compiling the kernel with a different compiler version due to those unstable features, but this fork is meant to be temporary: the original plan for <code>alloc</code> discussed with upstream Rust (and others) is documented in-tree in the <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/rust/alloc/README.md?h=v6.6"><code>rust/alloc/README.md</code></a> file.</p>
<p>Discussions with upstream Rust are ongoing to see what the eventual solution for <code>alloc</code> will be.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backporting-and-stablelts-releases"><a class="header" href="#backporting-and-stablelts-releases">Backporting and stable/LTS releases</a></h1>
<p>The <a href="https://www.kernel.org/category/releases.html"><em>stable</em> and <em>longterm</em> (LTS) kernel releases</a> only receive fixes, and thus <a href="https://docs.kernel.org/process/stable-kernel-rules.html">do not accept new features</a>. Therefore, it is not possible to backport Rust support into those kernel releases. Moreover, there is a significant cost in maintaining a stable branch.</p>
<p>Having said that, we are aware that there is growing interest in backported Rust support for, at least, 5.15 and 6.1. There are several questions around the possibility of supporting an stable/LTS release on Rust for Linux's side:</p>
<ul>
<li>
<p>Whether the support is best-effort or intended to be used in production, and the security and scheduling implications.</p>
</li>
<li>
<p>Whether all new abstractions, drivers and overall features appearing in mainline are backported, and whether those that require extra backports on the C side to support them should be included.</p>
</li>
<li>
<p>Whether the Rust version policy would be different than the one in mainline, e.g. whether the version would be fixed.</p>
</li>
<li>
<p>Whether to provide it as a rebasing branch (i.e. as a set of patches) on top of the stable/LTS ones or as an actual stable branch.</p>
</li>
</ul>
<p>If your company, organization or team would be interested in such releases with backported Rust support, then please <a href="Contact.html">contact us</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="third-party-crates"><a class="header" href="#third-party-crates">Third-party crates</a></h1>
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>Rust provides a package manager and build system called <a href="https://doc.rust-lang.org/cargo/">Cargo</a>. Rust also provides <a href="https://crates.io">crates.io</a>, its default package registry. In userspace, all these form a solution that a lot of open-source Rust projects use.</p>
<p>Some of those open-source libraries are potentially usable in the kernel because they only depend on <code>core</code> and <code>alloc</code> (rather than <code>std</code>), or because they only provide macro facilities.</p>
<p>Thus it is natural to consider whether some of these libraries could be reused for the kernel.</p>
<h2 id="suitability-of-a-crate"><a class="header" href="#suitability-of-a-crate">Suitability of a crate</a></h2>
<p>Even if a library only depends on <code>core</code> and <code>alloc</code>, it may still not be usable within the kernel for other reasons.</p>
<p>For instance, its license may be incompatible, it may not support fallible allocations, the kernel may only need a very small subset of what it supports (even if it supports configuring out some of its features), the kernel may already provide the same functionality on the C side (which could be abstracted), etc.</p>
<p>On top of that, the code of a crate may require some changes to be adapted for the kernel anyway. For instance, adding SPDX license identifiers, removing a dependency, tweaking some code, enabling an unstable feature, etc.</p>
<p>Moreover, new code arriving to the kernel should be maintained; and thus somebody needs to step up for that role.</p>
<p>Therefore, in general, whether a third-party crate is suitable for the kernel needs to be decided on a case-by-case basis.</p>
<h2 id="importing-crates"><a class="header" href="#importing-crates">Importing crates</a></h2>
<p>The kernel currently integrates some dependencies (e.g. some of the compression algorithms or our Rust <code>alloc</code> fork) by importing the files into its source tree, adapted as needed. In other words, they are not fetched/patched on demand.</p>
<p>There have been discussions about potentially incorporating a system where crates/libraries are fetched dynamically given a list of crates, versions, hashes, etc.; however, it remains to be seen whether such a system would be preferred and accepted.</p>
<h2 id="supporting-out-of-tree-modules"><a class="header" href="#supporting-out-of-tree-modules">Supporting out-of-tree modules</a></h2>
<p>The project is focused on getting features upstreamed, i.e. available for everybody. Therefore, if mainline does not support third-party crates and/or a system to fetch them dynamically, then it is unlikely it will be supported for out-of-tree modules.</p>
<h2 id="experiment"><a class="header" href="#experiment">Experiment</a></h2>
<p>Experimental integration for a few popular crates has been provided for interested users, e.g. <a href="https://github.com/Rust-for-Linux/linux/pull/1007">PR #1007</a> adds support for <code>proc-macro2</code>, <code>quote</code>, <code>syn</code>, <code>serde</code> and <code>serde_derive</code>.</p>
<h2 id="feedback-1"><a class="header" href="#feedback-1">Feedback</a></h2>
<p>We are looking for <a href="Contact.html">feedback</a> from other kernel developers, maintainers and companies on which third-party crates would be most useful to have in the kernel.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="out-of-tree-modules"><a class="header" href="#out-of-tree-modules">Out-of-tree modules</a></h1>
<p>The Linux kernel supports <a href="https://docs.kernel.org/kbuild/modules.html">building out-of-tree modules</a>. Both C and Rust modules can be developed as out-of-tree ones, and we provide a <a href="https://github.com/Rust-for-Linux/rust-out-of-tree-module">basic template</a> for an out-of-tree Linux kernel module written in Rust.</p>
<p>However, please note that the Rust for Linux project is part of the kernel and has always focused its efforts towards getting code into the mainline kernel.</p>
<p>In particular, this means that Rust <a href="https://docs.kernel.org/process/4.Coding.html#internal-api-changes">internal APIs can be changed at any time</a>, just like C ones, when the need arises. Similarly, code present at any point in our different <a href="Branches.html">branches</a> is not intended to form a stable base for out-of-tree development.</p>
<p>In addition, patches submitted to the mailing list should generally focus on in-tree development efforts. In particular, Rust abstractions submitted upstream require in-tree users. Abstractions intended for out-of-tree users cannot be merged. Even if those abstractions may be obviously useful for future in-tree users, there needs to be an agreed upon in-tree user.</p>
<p>For these reasons and others, please consider <a href="Contributing.html">submitting</a> your use cases upstream — see <a href="https://docs.kernel.org/process/1.Intro.html#the-importance-of-getting-code-into-the-mainline">the importance of getting code into the mainline</a>.</p>
<p>Having said that, we understand that some module development is done out-of-tree and may not be possible to upstream. Even in those cases, if your company, organization or team has a use case for Rust, please <a href="Contact.html">contact us</a>, since it is important to highlight those use cases early on in order to showcase the <a href="Industry-and-academia-support.html">interest from industry and academia</a> in Rust.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="industry-and-academia-support"><a class="header" href="#industry-and-academia-support">Industry and academia support</a></h1>
<blockquote id="Google" class="quote-highlight">
<p>“Google supports and contributes directly to the Rust for Linux project. Our Android team is evaluating a new Binder implementation and considering other drivers where Rust could be adopted.”</p>
</blockquote>
<p>— <a href="https://lore.kernel.org/lkml/20210704202756.29107-1-ojeda@kernel.org/">Google</a>, 2021.</p>
<blockquote id="Arm" class="quote-highlight">
<p>“Arm recognises the Rust value proposition and is actively working with the Rust community to improve Rust for Arm based systems.
A good example is Arm’s RFC contribution to the Rust language which made Linux on 64-bit Arm systems a Tier-1 Rust supported platform.</p>
<p>Rustaceans at Arm are excited about the Rust for Linux initiative and look forward to assisting in this effort.”</p>
</blockquote>
<p>— <a href="https://lore.kernel.org/lkml/20210704202756.29107-1-ojeda@kernel.org/">Arm</a>, 2021-06-29.</p>
<blockquote id="Microsoft" class="quote-highlight">
<p>“Microsoft's Linux Systems Group is interested in contributing to getting Rust into Linux kernel. Hopefully we will be able to submit select Hyper-V drivers written in Rust in the coming months.”</p>
</blockquote>
<p>— <a href="https://lore.kernel.org/lkml/20210704202756.29107-1-ojeda@kernel.org/">Microsoft</a>, 2021-06-29.</p>
<blockquote id="RedHat" class="quote-highlight">
<p>“There is interest in using Rust for kernel work that Red Hat is considering.”</p>
</blockquote>
<p>— <a href="https://lore.kernel.org/lkml/20211206140313.5653-1-ojeda@kernel.org/">Red Hat</a>, 2021-07-08.</p>
<blockquote id="Anderson" class="quote-highlight">
<p>“Rust for Linux is a key step towards reducing security-critical kernel bugs, and on the path towards our ultimate goal of making Linux free of security-critical bugs. We are using Rust in our OS research, and adoption is easier with an existing Rust in the Linux kernel framework in place.”</p>
</blockquote>
<p>— Thomas Anderson, University of Washington, 2022-06-23.</p>
<blockquote id="BlancCohenSchmidt" class="quote-highlight">
<p>“We are convinced that Rust is changing the landscape of system programming by applying the research done on programming languages in the last decades. We wanted to see how the language was able to help us write code we are really comfortable with thanks to the extensive static checking.”</p>
</blockquote>
<p>— Esteban Blanc, Arthur Cohen and Martin Schmidt, LSE (Systems Research Laboratory) at EPITA (École pour l'informatique et les techniques avancées), 2022-06-23.</p>
<blockquote id="ISRG" class="quote-highlight">
<p>“Being able to use Rust in the Linux kernel is an incredible milestone on the road to a more secure future for the Internet and everything else that depends heavily on Linux.”</p>
</blockquote>
<p>— <a href="https://www.memorysafety.org/blog/rust-in-linux-just-the-beginning/">ISRG's Prossimo Project</a>, 2022-10-18.</p>
<blockquote id="Samsung" class="quote-highlight">
<p>“Samsung is actively engaged in supporting the integration of Rust code into the Linux Kernel. Recognizing the significant benefits that Rust brings to kernel and system software development, particularly in terms of enhancing security and reducing critical bugs, Samsung is committed to enabling kernel developers to write block layer device drivers using the Rust programming language. By embracing modern programming languages like Rust, Samsung aims to attract new talent to systems development and promote memory safety within the Linux storage stack.”</p>
</blockquote>
<p>— Samsung, 2023-05-17.</p>
<blockquote id="Cisco" class="quote-highlight">
<p>“Cisco supports the inclusion and development of Rust in the Linux kernel as a way of eliminating memory safety bugs and vulnerabilities. We are developing a next-generation container filesystem in Rust and, to this end, we are contributing time, code, and the testing effort to the Rust for Linux project.”</p>
</blockquote>
<p>— Cisco, 2023-09-14.</p>
<blockquote id="Collabora" class="quote-highlight">
<p>“Collabora feels privileged to partner with customers who envision Rust as an integral part of the Linux kernel's future. We are committed to supporting the integration of Rust into as many Linux subsystems as appropriate over the coming years. By doing so, this will enable our customers, and many more developers, to increase the reliability of their Linux kernel contributions. We extend our gratitude for the activities undertaken by the Rust for Linux Initiative.”</p>
</blockquote>
<p>— Collabora, 2023-09-22.</p>
<hr />
<p>If your company, organization, university or team is using or plans to use Rust for Linux and would like to release a statement, then please <a href="Contact.html">contact us</a>. Thank you!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sponsors"><a class="header" href="#sponsors">Sponsors</a></h1>
<h2 id="prossimo-project"><a class="header" href="#prossimo-project">Prossimo project</a></h2>
<p><a href="https://www.abetterinternet.org">Internet Security Research Group (ISRG)</a>, through their <a href="https://www.memorysafety.org/initiative/linux-kernel/">Prossimo</a> project, supports Miguel Ojeda and supported Gary Guo to work on Rust for Linux, which was made possible with generous financial support from Google and Futurewei.</p>
<blockquote style="display: flex; column-gap: 20px; align-items: center;flex-wrap: wrap;">
  <div style="flex: 0 1 300px; margin-top: 20px; margin-bottom: 20px;background: white;padding: 30px;border-radius: 10px;row-gap: 20px;display: flex;flex-direction: column;margin-left: auto;margin-right: auto;">
    <a href="https://www.abetterinternet.org"><img src="ISRG.svg" alt="ISRG Logo"></a>
    <a href="https://www.memorysafety.org"><img src="Prossimo.svg" alt="Prossimo Logo"></a>
  </div>
  <div style="flex: 300px;">
    <p>“Our mission is to reduce financial, technological, and educational barriers to secure communication over the Internet.”</p>
    <p>“Prossimo is an Internet Security Research Group (ISRG) project. Its goal is to improve the Internet's security-sensitive software infrastructure by addressing memory safety issues in C and C++ code via the use of memory safe languages.”</p>
  </div>
</blockquote>
<div style="background: white; margin-top: 2.5em; border-radius: 10px; padding: 20px; display: flex; align-items: center; justify-content: center; column-gap: 4%;">
    <div style="flex: 14 1 0;"><img style="width: 100%; height: auto;" src="Google.svg" alt="Google Logo"></div>
    <div style="flex:  9 1 0;"><img style="width: 100%; height: auto;" src="Futurewei.png" alt="Futurewei Logo"></div>
</div>
<h2 id="zulip"><a class="header" href="#zulip">Zulip</a></h2>
<p><a href="https://zulip.com">Zulip</a> sponsors free Zulip Cloud Standard hosting for Rust for Linux.</p>
<blockquote style="display: flex; column-gap: 20px; align-items: center;">
  <div style=" flex: 0 0 50px; margin-top: 20px; margin-bottom: 20px;">
    <a href="https://zulip.com"><img src="Zulip.svg" alt="Zulip Logo"></a>
  </div>
  <p>“Zulip is an open-source modern team chat app designed to keep both live and asynchronous conversations organized.”</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="klint"><a class="header" href="#klint"><code>klint</code></a></h1>
<p><a href="https://github.com/Rust-for-Linux/klint"><code>klint</code></a> is a tool that allows to introduce extra static analysis passes (&quot;lints&quot;) in Rust kernel code, leveraging the Rust compiler as a library. One of the first lints available <a href="https://www.memorysafety.org/blog/gary-guo-klint-rust-tools/">validates that Rust code follows the kernel locking rules</a> by tracking the preemption count at compile-time.</p>
<p>The main developer and maintainer is Gary Guo.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pinned-init"><a class="header" href="#pinned-init"><code>pinned-init</code></a></h1>
<p><a href="https://github.com/Rust-for-Linux/pinned-init"><code>pinned-init</code></a> is a solution to <a href="The-Safe-Pinned-Initialization-Problem.html">The Safe Pinned Initialization Problem</a>. It provides safe and fallible initialization of pinned structs using in-place constructors.</p>
<p>The main developer and maintainer is y86-dev.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-safe-pinned-initialization-problem"><a class="header" href="#the-safe-pinned-initialization-problem">The Safe Pinned Initialization Problem</a></h1>
<h2 id="introduction-to-pinning"><a class="header" href="#introduction-to-pinning">Introduction to Pinning</a></h2>
<p>In the kernel many data structures are not allowed to change address, since there exist external pointers to them that would then be invalidated. Since this could cause memory errors, Rust has to <em>somehow</em> guarantee that this cannot happen in safe code. Luckily there already exists the <a href="https://doc.rust-lang.org/core/pin/struct.Pin.html"><code>Pin&lt;P&gt;</code></a> wrapper type for arbitrary pointer types <code>P</code>. For simplicity we will look at <code>P = Box&lt;T&gt;</code>. <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box&lt;T&gt;</code></a> is a smart pointer that owns a <code>T</code> (a generic parameter) allocated on the heap. When a <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box&lt;T&gt;</code></a> is dropped (destroyed) then it automatically frees the memory.</p>
<p><code>Pin&lt;Box&lt;T&gt;&gt;</code> behaves similar to <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box&lt;T&gt;</code></a>, it is also a smart pointer and allows you to have immutable access to the fields and functions of <code>T</code>. You can also store it just as easily, since it also has the same size as <code>Box&lt;T&gt;</code>.</p>
<p>One important difference compared to just <code>Box&lt;T&gt;</code> is that <code>Pin</code> prevents mutable access to the underlying <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box&lt;T&gt;</code></a> and thus makes it impossible to move the pointee. So users are unable to call e.g. <a href="https://doc.rust-lang.org/core/mem/fn.swap.html"><code>mem::swap</code></a>. This is of course a heavy restriction, so there exist <code>unsafe</code> functions that allow modification and access to <code>&amp;mut T</code> and so called pin-projections to access fields of <code>T</code>. However, when using these functions, it is the caller's responsibility to uphold the pinning guarantee.</p>
<p>This guarantee also includes that the object is <code>drop</code>ed before the memory is deallocated or repurposed. At first glance, this requirement seems strange. But after this example it will hopefully seem very natural. Let's imagine that we want to design a Rust version of <code>list_head</code><sup class="footnote-reference"><a href="#1">1</a></sup>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// # Invariants
///
/// `next` and `prev` always point to a valid `ListHead`.
struct ListHead {
    next: *mut ListHead,
    prev: *mut ListHead,
}
<span class="boring">}</span></code></pre></pre>
<p>Then we need to ensure that as long as an element is in a list, it will stay alive, since it would cause a UAF (use after free) otherwise. A simple way to achieve this, is to remove it from the list, when it gets dropped:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Drop for ListHead {
    fn drop(&amp;mut self) {
        let prev = self.prev;
        let next = self.next;
        // SAFETY: By the invariant, these pointers are valid.
        unsafe {
            (*next).prev = prev;
            (*prev).next = next;
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<p>And this is the important bit, if we were to just deallocate/reuse the memory of a <code>ListHead</code> without dropping it first, by e.g. using <a href="https://doc.rust-lang.org/core/ptr/fn.write.html"><code>ptr::write</code></a>, then we are just begging for a UAF to happen.</p>
<p>Because the <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box&lt;T&gt;</code></a> smart pointer owns its memory, it cannot be used for a function which does not consume the value. For this reason the mutable reference <code>&amp;mut T</code> is used. When dealing with <code>Pin&lt;Box&lt;T&gt;&gt;</code>, we cannot access <code>&amp;mut T</code>. Instead we can access <code>Pin&lt;&amp;mut T&gt;</code> which still upholds the pinning guarantee.</p>
<h2 id="adding-initialization-into-the-mix"><a class="header" href="#adding-initialization-into-the-mix">Adding Initialization into the mix</a></h2>
<p>What does initialization have to do with pinning? In the first paragraph nothing suggested that there would be a connection. One important feature of Rust forces this connection. In Rust all values have to be initialized at <em>all</em> times. This is a problem for creating our <code>ListHead</code> the usual Rust way; a <code>new()</code> function that returns the object by value. Since we first need to know its address before we can initialize <code>next</code> and <code>prev</code> to point to itself.</p>
<p>Rust has a way around the &quot;values are vaild at all times&quot; problem: <code>MaybeUninit&lt;T&gt;</code> is a wrapper that explicitly allows uninitialized values. <code>unsafe</code> functions are then used to access the <code>T</code> once initialized. For our <code>ListHead</code> we could simply allocate a <code>MaybeUninit&lt;ListHead&gt;</code> and then write its address using raw pointers into <code>next</code> and <code>prev</code>. However, as already said above, in Rust the normal way of creating an object is to return it by value. We cannot do this for the <code>ListHead</code>, since that would move it and invalidate its pointers. The alternative of allocating it on the heap, i.e. returning a <code>Pin&lt;Box&lt;ListHead&gt;&gt;</code> also does not work, since this list should be part of a bigger struct.</p>
<p>This is the reason why Rust-for-Linux chose a two-function approach:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl ListHead {
    /// Creates a new [`ListHead`].
    ///
    /// # Safety
    ///
    /// Before using this [`ListHead`] the caller has to call [`ListHead::init`].
    unsafe fn new() -&gt; ListHead {
        ListHead {
            next: ptr::null_mut(),
            prev: ptr::null_mut(),
        }
    }

    /// Initializes this [`ListHead`].
    ///
    /// # Safety
    ///
    /// This function is only called once.
    unsafe fn init(self: Pin&lt;&amp;mut Self&gt;) {
        // SAFETY: We do not move `self`.
        let this: &amp;mut Self = unsafe { self.get_unchecked_mut() };
        let ptr: *mut ListHead = this;
        unsafe {
            (*ptr).prev = ptr;
            (*ptr).next = ptr;
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<p>This approach avoids having to allocate and lets the user decide the memory location of the <code>ListHead</code>. It also ensures that a <code>ListHead</code> will be pinned in memory, since the <code>self</code> type of <code>init</code> is <code>Pin&lt;&amp;mut Self&gt;</code>. Both functions have to be marked <code>unsafe</code>, since the safety preconditions cannot be enforced by the compiler. We also have to use two functions, since after a call to <code>new</code> the caller will have to pin the value in memory prior to calling <code>init</code>.</p>
<p>The biggest problem with this approach is that it exclusively relies on the programmer to ensure safety. It is very easy to forget such an <code>init</code> call when you have a struct with multiple fields that require this treatment. This problem is exacerbated by the fact that this API propagates to all structs that contain a <code>ListHead</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct DoubleList {
    list_a: ListHead,
    list_b: ListHead,
}

impl DoubleList {
    /// # Safety
    ///
    /// Before using this [`DoubleList`] the caller has to call [`DoubleList::init`].
    unsafe fn new() -&gt; ListHead {
        DoubleList {
            // SAFETY: We call `ListHead::init` in our own initializer.
            list_a: unsafe { ListHead::new() },
            // SAFETY: We call `ListHead::init` in our own initializer.
            list_b: unsafe { ListHead::new() },
        }
    }

    /// # Safety
    ///
    /// This function is only called once.
    unsafe fn init(self: Pin&lt;&amp;mut Self&gt;) {
        // SAFETY: We structurally pin `list_a`.
        let list_a = unsafe { self.map_unchecked_mut(|s| &amp;mut s.list_a) };
        // SAFETY: Our function is only called once.
        unsafe { ListHead::init(list_a) };
        // SAFETY: We structurally pin `list_b`.
        let list_b = unsafe { self.map_unchecked_mut(|s| &amp;mut s.list_b) };
        // SAFETY: Our function is only called once.
        unsafe { ListHead::init(list_b) };
    }
}
<span class="boring">}</span></code></pre></pre>
<p>So not only the <code>kernel</code> crate developers have to cope with this API, but <em>everyone</em> who dares to have a <code>Mutex&lt;T&gt;</code> in their struct, or use a struct that transitively contains a <code>Mutex&lt;T&gt;</code>.</p>
<h2 id="pin-complications"><a class="header" href="#pin-complications">Pin Complications</a></h2>
<p>The previous example also shows a different, but related issue: pin-projections. These are how we access the fields of pinned structs. And because one can break the pinning guarantee the <code>map_unchecked_mut</code> function has to be <code>unsafe</code>. The requirement for them is consistency, you are only allowed to either structurally pin a field, so you allow the access of <code>Pin&lt;&amp;mut Struct&gt; -&gt; Pin&lt;&amp;mut Field&gt;</code>, or you do not structurally pin the field, i.e. allowing <code>Pin&lt;&amp;mut Struct&gt; -&gt; &amp;mut Field</code>. As long as only one of those options is done, the pinning guarantee is upheld.</p>
<p>In userland Rust this problem is addressed by using the <a href="https://crates.io/crates/pin-project"><code>pin-project</code></a> crate. This crate generates the pin-projections from the struct definition:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[pin_project]
struct DoubleList {
    #[pin]
    list_a: ListHead,
    #[pin]
    list_b: ListHead,
}
<span class="boring">}</span></code></pre></pre>
<p>Now both fields are structurally pinned and can be safely accessed.</p>
<p>This crate cannot be used in the kernel, since it relies on <a href="https://crates.io/crates/syn"><code>syn</code></a> -- the de facto Rust code parsing library for proc-macros. The problem with including <a href="https://crates.io/crates/syn"><code>syn</code></a> in the kernel is that it consists of over 50k lines of code.</p>
<p>There is also the <a href="https://crates.io/crates/pin-project-lite"><code>pin-project-lite</code></a> crate that achieves almost the same thing without a proc-macro. It has 5k lines of code and contains a very complex macro that would require further modification to serve this purpose, which would be hard to maintain.</p>
<p>These reasons ultimately resulted in not using any of the existing approaches. The problem of pin projections also prompted the creation of the <a href="https://github.com/rust-lang/rfcs/pull/3318">field projection RFC</a>.</p>
<p>If you now want to view how to use the API, then take a look at the <a href="https://rust-for-linux.github.io/docs/pinned-init/kernel/init/">extensive documentation</a>.</p>
<h2 id="further-resources-on-pinning"><a class="header" href="#further-resources-on-pinning">Further Resources on Pinning</a></h2>
<ul>
<li>Rust documentation: <a href="https://doc.rust-lang.org/core/pin/index.html">https://doc.rust-lang.org/core/pin/index.html</a></li>
<li>Pinning and its problems outlined in the context of futures: <a href="https://fasterthanli.me/articles/pin-and-suffering">https://fasterthanli.me/articles/pin-and-suffering</a></li>
<li>Pinning in Rust -- Kangrejos Presentation <a href="https://kangrejos.com">https://kangrejos.com</a> Slides: <a href="https://kangrejos.com/Pinning%20in%20Rust.pdf">https://kangrejos.com/Pinning%20in%20Rust.pdf</a></li>
</ul>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>The example presented here, glosses over some very important details. The <code>next</code> and <code>prev</code>
fields of the <code>ListHead</code> struct should actually be placed in <a href="https://doc.rust-lang.org/core/cell/struct.Cell.html"><code>Cell&lt;T&gt;</code></a>s to allow modification
through <code>&amp;ListHead</code>, since we cannot have multiple <code>&amp;mut ListHead</code>s at the same time. And we
need to have multiple when iterating through a list. Also, <code>ListHead</code> should contain a
<code>PhantomPinned</code> field to ensure it cannot be unpinned.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ksquirrel"><a class="header" href="#ksquirrel">Ksquirrel</a></h1>
<p><a href="https://github.com/ksquirrel">Ksquirrel</a> was a GitHub bot that helped newcomers to the kernel get accustomed to the kernel requirements for submissions (e.g. checking that commit messages were properly signed and formatted). It was also useful as a double-check for maintainers that they did not forget to check those requirements.</p>
<p>We may bring it back for mailing list submissions!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="coccinelle-for-rust"><a class="header" href="#coccinelle-for-rust">Coccinelle for Rust</a></h1>
<p>Coccinelle is a tool for automatic program matching and transformation that
was originally developed for making large scale changes to the Linux kernel
source code (ie, C code).  Matches and transformations are driven by
user-specific transformation rules having the form of abstracted patches,
referred to as semantic patches. As the Linux kernel, and systems software
more generally, is starting to adopt Rust, we are developing Coccinelle for
Rust, to make the power of Coccinelle available to Rust codebases.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>Changing a method call sequence in the Rust implementation:</p>
<pre><code class="language-diff hljs"><span class="hljs-title">@@</span>
<span class="hljs-keyword">expression</span> tcx, arg;
<span class="hljs-title">@@</span>
<span class="hljs-deletion">- tcx.type_of(arg)</span>
<span class="hljs-addition">+ tcx.bound_type_of(arg).subst_identity()</span>
</code></pre>
<p>Replace Generic Bound with Impl Trait:</p>
<pre><code class="language-diff hljs"><span class="hljs-title">@@</span>
<span class="hljs-keyword">identifier</span> f, P, p;
<span class="hljs-keyword">type</span> T1, T2;
<span class="hljs-title">@@</span>
<span class="hljs-deletion">- f&lt;P: T1&gt;(p: P) -&gt; T2</span>
<span class="hljs-addition">+ f(p: impl T1) -&gt; T2</span>
     { ... }
</code></pre>
<h2 id="current-status"><a class="header" href="#current-status">Current status</a></h2>
<p>Coccinelle for Rust is currently a prototype.  It relies on Rust Analyzer
for parsing and rustfmt for pretty printing.  It mainly supports matching
and transformation of expressions and types, but reasoning about control
flow is not yet supported.</p>
<h2 id="availability"><a class="header" href="#availability">Availability</a></h2>
<p><a href="https://gitlab.inria.fr/coccinelle/coccinelleforrust.git">Coccinelle for Rust</a></p>
<p><a href="https://gitlab.inria.fr/coccinelle/coccinelleforrust/-/blob/main/talks/rfl.pdf">A recent talk about Coccinelle for Rust</a></p>
<h2 id="contact-1"><a class="header" href="#contact-1">Contact</a></h2>
<ul>
<li>Julia Lawall: <a href="mailto:Julia.Lawall@inria.fr">Julia.Lawall@inria.fr</a></li>
<li>Tathagata Roy: <a href="mailto:tathagata.roy1278@gmail.com">tathagata.roy1278@gmail.com</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rustc_codegen_gcc"><a class="header" href="#rustc_codegen_gcc"><code>rustc_codegen_gcc</code></a></h1>
<p><a href="https://github.com/rust-lang/rustc_codegen_gcc"><code>rustc_codegen_gcc</code></a> is a GCC ahead-of-time codegen for rustc, meaning that it can be loaded by the existing rustc frontend, but benefits from GCC by having more architectures supported and having access to GCC’s optimizations.</p>
<p>Rust for Linux can be compiled with <code>rustc_codegen_gcc</code> which allows to have a GCC-compiled Linux kernel with Rust kernel modules compiled with GCC as well.</p>
<p><a href="https://blog.antoyo.xyz/">Blog with updates about the progress of the GCC codegen.</a></p>
<h2 id="building-rustc_codegen_gcc-and-the-sysroot"><a class="header" href="#building-rustc_codegen_gcc-and-the-sysroot">Building <code>rustc_codegen_gcc</code> and the sysroot</a></h2>
<p>The following have been tested with GCC commit <a href="https://github.com/antoyo/gcc/commit/b334f15ed21c95868059a16484a1948be08e26a3">b334f15ed21c95868059a16484a1948be08e26a3</a> and <code>rustc_codegen_gcc</code> commit <a href="https://github.com/rust-lang/rustc_codegen_gcc/commit/c6bc7ecd65046ee502118664f42637ca318cdfb5">c6bc7ecd65046ee502118664f42637ca318cdfb5</a>.</p>
<p>Follow the build instructions <a href="https://github.com/rust-lang/rustc_codegen_gcc#building">here</a>.</p>
<h2 id="building-rust-for-linux"><a class="header" href="#building-rust-for-linux">Building Rust for Linux</a></h2>
<p>Follow the <a href="https://docs.kernel.org/rust/quick-start.html">Rust for Linux Quick Start instructions</a> with a few changes as explained below.</p>
<p>Since the GCC codegen might not work on every nightly version (that should soon be fixed now that we run some tests in the Rust CI), we're going to use <a href="https://github.com/rust-lang/rustc_codegen_gcc/blob/master/rust-toolchain">the same nightly version as the GCC codegen</a> instead of using the version recommended by Rust for Linux:</p>
<pre><code class="language-sh">rustup override set nightly-2023-10-21 # Adjust to the version used by the GCC codegen.
</code></pre>
<p>Now, you need to set some variables to build Rust for Linux with the GCC codegen (do not forget to adjust your path to <code>rustc_codegen_gcc</code>):</p>
<pre><code class="language-sh">make -j20 KRUSTFLAGS=&quot;-Zcodegen-backend=/path/to/rustc_codegen_gcc/target/debug/librustc_codegen_gcc.so \
    --sysroot /path/to/rustc_codegen_gcc/build_sysroot/sysroot&quot; \
    HOSTRUSTFLAGS=&quot;-Zcodegen-backend=/path/to/rustc_codegen_gcc/target/debug/librustc_codegen_gcc.so \
    --sysroot /path/to/rustc_codegen_gcc/build_sysroot/sysroot -Clto=no&quot;
</code></pre>
<p>Since we use a different nightly version, you might need to adjust the code of the <code>alloc</code> crate built by Rust for Linux.
You'll see some errors when running the above command in this case.</p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<p>If that didn't build the Rust object files, run <code>make menuconfig</code> again and check if the &quot;Rust support&quot; is available.
It could be that you have <code>RUST_IS_AVAILABLE [=n]</code>.
In that case, run <code>make rustavailable</code> with the <code>KRUSTFLAGS</code> you used above.
That should give you the correct error, which could be one of those:</p>
<ul>
<li><code>libgccjit.so.0: cannot open shared object file: No such file or directory</code>
<ul>
<li>In this case, make sure you set <code>LD_LIBRARY_PATH</code> and <code>LIBRARY_PATH</code>.</li>
</ul>
</li>
<li><code>Source code for the 'core' standard library could not be found</code>
<ul>
<li>In this case, make sure you used a recent enough version of <code>rustc_codegen_gcc</code> (c6bc7ecd65046ee502118664f42637ca318cdfb5 or more recent should be good) that copies the source of the sysroot at the correct location.</li>
</ul>
</li>
</ul>
<h2 id="contact-2"><a class="header" href="#contact-2">Contact</a></h2>
<p>Please contact Antoni Boucher (antoyo) on
<a href="https://web.libera.chat/#rustc_codegen_gcc">IRC</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nvme-driver"><a class="header" href="#nvme-driver">NVMe Driver</a></h1>
<p>The Rust NVMe driver is an effort to implement a PCI NVMe driver in safe Rust
for use in the Linux Kernel. The purpose of the driver is to provide a vehicle
for development of safe Rust abstractions and to prove feasibility of Rust as an
implementation language for high performance device drivers.</p>
<p>The Linux Rust NVMe driver lives
<a href="https://github.com/metaspace/linux/tree/nvme">here</a>. This branch is routinely
rebased on upstream Linux releases. Please be aware that the <code>nvme</code> branch is
force pushed without notice. The version based on the deprecated <code>rust</code> branch
is available <a href="https://github.com/metaspace/linux/tree/nvme-rust">here</a>.</p>
<p>The Rust NVMe driver was originally
authored by Wedson Almeida Filho and is now maintained by Andreas Hindborg
(Samsung).</p>
<p>The driver is not currently suitable for general use.</p>
<h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<ul>
<li>LPC 2022
<a href="https://lpc.events/event/16/contributions/1180/attachments/1017/1961/deck.pdf">slides</a>
and <a href="https://lpc.events/event/16/contributions/1180/attachments/1017/2249/go">video</a></li>
</ul>
<h1 id="67-rebase-performance-nvme-67"><a class="header" href="#67-rebase-performance-nvme-67">6.7 Rebase Performance (<a href="https://github.com/metaspace/linux/tree/nvme-6.7"><code>nvme-6.7</code></a>)</a></h1>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>1x INTEL MEMPEK1W016GA (PCIe 3.0 x2)</li>
<li>Debian Bullseye userspace</li>
<li>LTO results are enabled by a build system patch (a hack) that was not yet published.</li>
</ul>
<h2 id="results"><a class="header" href="#results">Results</a></h2>
<ul>
<li>30 samples</li>
<li>Difference of means modeled with t-distribution</li>
<li>P99 confidence intervals</li>
</ul>
<p><img src="rnvme/nvme-all-6.7.svg" alt="" /></p>
<h3 id="difference-relative"><a class="header" href="#difference-relative">Difference Relative</a></h3>
<p>Plot shows <code>(mean_iops_r - mean_iops_c) / mean_iops_c</code>'</p>
<p><img src="rnvme/nvme-diff-relative-6.7.svg" alt="" /></p>
<h1 id="performance-november-2023-nvme-66"><a class="header" href="#performance-november-2023-nvme-66">Performance November 2023 (<a href="https://github.com/metaspace/linux/tree/nvme-6.6"><code>nvme-6.6</code></a>)</a></h1>
<h2 id="setup-1"><a class="header" href="#setup-1">Setup</a></h2>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>1x INTEL MEMPEK1W016GA (PCIe 3.0 x2)</li>
<li>Debian Bullseye userspace</li>
<li>LTO results are enabled by a build system patch (a hack) that was not yet published.</li>
</ul>
<h2 id="results-1"><a class="header" href="#results-1">Results</a></h2>
<ul>
<li>30 samples</li>
<li>Difference of means modeled with t-distribution</li>
<li>P99 confidence intervals</li>
</ul>
<p><img src="rnvme/nvme-all-6.6.svg" alt="" /></p>
<h3 id="difference"><a class="header" href="#difference">Difference</a></h3>
<p><img src="rnvme/nvme-diff-6.6.svg" alt="" /></p>
<h3 id="difference-relative-1"><a class="header" href="#difference-relative-1">Difference Relative</a></h3>
<p>Plot shows <code>(mean_iops_r - mean_iops_c) / mean_iops_c</code>'</p>
<p><img src="rnvme/nvme-diff-relative-6.6.svg" alt="" /></p>
<h1 id="performance-september-2023"><a class="header" href="#performance-september-2023">Performance September 2023</a></h1>
<p>The driver was
<a href="https://github.com/metaspace/linux/tree/7353a81d566510080f91099b1a2b31895c716c9d">rebased</a>
on top of
<a href="https://github.com/Rust-for-Linux/linux/commit/37152d4a7c6400a4250134e601eca8be1a2bbc16"><code>rust-next</code></a>
PR for 6.6 in September 2023.</p>
<h2 id="setup-2"><a class="header" href="#setup-2">Setup</a></h2>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>1x INTEL MEMPEK1W016GA (PCIe 3.0 x2)</li>
<li>Debian Bullseye userspace</li>
</ul>
<h2 id="results-2"><a class="header" href="#results-2">Results</a></h2>
<p><img src="./nvme-512.svg" alt="iops-512" />
<img src="./nvme-all.svg" alt="iops-all" /></p>
<h1 id="performance-january-2023"><a class="header" href="#performance-january-2023">Performance January 2023</a></h1>
<p>Performance evaluation as of January 2023.</p>
<h2 id="setup-3"><a class="header" href="#setup-3">Setup</a></h2>
<ul>
<li>Dell PowerEdge R6525</li>
<li>1 CPU socket populated - EPYC 7313, 16 cores</li>
<li>128 GB DRAM</li>
<li>3x P5800x 16GT/s x4 7.88 GB/s (PCIe 4)</li>
<li>Debian bullseye (linux 5.19.0+)</li>
</ul>
<h2 id="results-3"><a class="header" href="#results-3">Results</a></h2>
<p><img src="./iops.svg" alt="iops" />
<img src="./relative.svg" alt="relative" /></p>
<h2 id="analysis"><a class="header" href="#analysis">Analysis</a></h2>
<p>For 4 KiB block size, the Rust NVMe driver performs similar to the C driver. For
this configuration the target drive is bandwidth limited.</p>
<p>For 512 B block size, the C driver outperforms the Rust driver by up to 6%. In
this configuration the drive is not bandwidth limited, but the benchmark becomes
compute limited. The Rust driver has a higher overhead and thus performs worse.</p>
<h1 id="work-items"><a class="header" href="#work-items">Work Items</a></h1>
<ul>
<li>Remove all unsafe code from the driver</li>
<li>Support device removal</li>
<li>Verify functionality by executing <code>blktests</code> and <code>xfstests</code> in CI</li>
<li>Add sys-fs nodes to allow use of <code>nvme-cli</code> with Rust NVMe driver</li>
<li>Support more kernel configurations by deferring initialization to a task queue</li>
<li>Improve performance of Rust NVMe driver</li>
</ul>
<h1 id="contact-3"><a class="header" href="#contact-3">Contact</a></h1>
<p>Please contact Andreas Hindborg through
<a href="Contact.html#zulip-chat">Zulip</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="null-block-driver"><a class="header" href="#null-block-driver">Null Block Driver</a></h1>
<p>The Rust null block driver <code>rnull</code> is an effort to implement a drop in
replacement for <code>null_blk</code> in Rust.</p>
<p>A null block driver is a good opportunity to evaluate Rust bindings for the
block layer. It is a small and simple driver and thus should be simple to reason
about. Further, the null block driver is not usually deployed in production
environments. Thus, it should be fairly straight forward to review, and any
potential issues are not going to bring down any production workloads.</p>
<p>Being small and simple, the null block driver is a good place to introduce the
Linux kernel storage community to Rust. This will help prepare the community for
future Rust projects and facilitate a better maintenance process for these
projects.</p>
<p><a href="https://lore.kernel.org/all/87y1ofj5tt.fsf@metaspace.dk/">Statistics</a> from the
commit log of the <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/block/null_blk?h=v6.1">C <code>null_blk</code>
driver</a>
(<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/drivers/block/null_blk_main.c?h=v6.1&amp;id=ea17fd354ca8afd3e8962a77236b1a9a59262fdd">before
move</a>)
show that the C null block driver has had a significant amount of memory safety
related problems in the past. 41% of fixes merged for the C null block driver
are fixes for memory safety issues. This makes the null block driver a good
candidate for rewriting in Rust.</p>
<p>The driver is implemented entirely in safe Rust, with all unsafe code fully
contained in the abstractions that wrap the C APIs.</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<p>Implemented features:</p>
<ul>
<li><code>blk-mq</code> support</li>
<li>Direct completion</li>
<li>SoftIRQ completion</li>
<li>Timer completion</li>
<li>Read and write requests</li>
<li>Optional memory backing</li>
</ul>
<p>Features available in the C <code>null_blk</code> driver that are currently not implemented
in this work:</p>
<ul>
<li>Bio-based submission</li>
<li>NUMA support</li>
<li>Block size configuration</li>
<li>Multiple devices</li>
<li>Dynamic device creation/destruction</li>
<li>Queue depth configuration</li>
<li>Queue count configuration</li>
<li>Discard operation support</li>
<li>Cache emulation</li>
<li>Bandwidth throttling</li>
<li>Per node hctx</li>
<li>IO scheduler configuration</li>
<li>Blocking submission mode</li>
<li>Shared tags configuration (for &gt;1 device)</li>
<li>Zoned storage support</li>
<li>Bad block simulation</li>
<li>Poll queues</li>
</ul>
<h2 id="resources-1"><a class="header" href="#resources-1">Resources</a></h2>
<ul>
<li><a href="https://github.com/metaspace/linux/tree/rnull">Latest patches</a></li>
<li><a href="https://github.com/metaspace/linux/tree/null_block-RFC">Original RFC Patches</a></li>
<li><a href="https://lore.kernel.org/all/20230503090708.2524310-1-nmi@metaspace.dk/">Mailing List Post</a></li>
</ul>
<h1 id="67-rebase-rnull-67"><a class="header" href="#67-rebase-rnull-67">6.7 Rebase (<a href="https://github.com/metaspace/linux/tree/rnull-6.7"><code>rnull-6.7</code></a>)</a></h1>
<p>Changes from null_blk-6.6:</p>
<ul>
<li>Move to <code>Folio</code> for memory backing instead of <code>Page</code></li>
<li>Move to <code>XArray</code> for memory backing instead of <code>RaddixTree</code></li>
</ul>
<h2 id="performance"><a class="header" href="#performance">Performance</a></h2>
<h3 id="setup-4"><a class="header" href="#setup-4">Setup</a></h3>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>Debian Bullseye userspace</li>
</ul>
<h3 id="results-4"><a class="header" href="#results-4">Results</a></h3>
<ul>
<li>Plot shows <code>(mean_iops_r - mean_iops_c) / mean_iops_c</code></li>
<li>40 samples</li>
<li>Difference of means modeled with t-distribution</li>
<li>P95 confidence intervals</li>
</ul>
<p><img src="rnull/rnull-6.7.svg" alt="" /></p>
<h1 id="performance-september-2023-null_blk-66"><a class="header" href="#performance-september-2023-null_blk-66">Performance September 2023 (<a href="https://github.com/metaspace/linux/tree/null_blk-6.6"><code>null_blk-6.6</code></a>)</a></h1>
<h2 id="setup-5"><a class="header" href="#setup-5">Setup</a></h2>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>1x INTEL MEMPEK1W016GA (PCIe 3.0 x2)</li>
<li>Debian Bullseye userspace</li>
</ul>
<h2 id="results-5"><a class="header" href="#results-5">Results</a></h2>
<ul>
<li>Plot shows <code>(mean_iops_r - mean_iops_c) / mean_iops_c</code></li>
<li>40 samples</li>
<li>Difference of means modeled with t-distribution</li>
<li>P95 confidence intervals</li>
</ul>
<p><img src="rnull/null_blk-6.6.svg" alt="" /></p>
<h1 id="performance-september-2023-1"><a class="header" href="#performance-september-2023-1">Performance September 2023</a></h1>
<h2 id="setup-6"><a class="header" href="#setup-6">Setup</a></h2>
<ul>
<li>12th Gen Intel(R) Core(TM) i5-12600</li>
<li>32 GB DRAM</li>
<li>1x INTEL MEMPEK1W016GA (PCIe 3.0 x2)</li>
<li>Debian Bullseye userspace</li>
</ul>
<h2 id="results-6"><a class="header" href="#results-6">Results</a></h2>
<p>In most cases there is less than 2% difference between the Rust and C drivers.</p>
<p><img src="./rnull/read-iops.svg" alt="" />
<img src="./rnull/write-iops.svg" alt="" />
<img src="./rnull/randread-iops.svg" alt="" />
<img src="./rnull/randwrite-iops.svg" alt="" />
<img src="./rnull/readwrite-iops.svg" alt="" />
<img src="./rnull/randrw-iops.svg" alt="" /></p>
<h1 id="contact-4"><a class="header" href="#contact-4">Contact</a></h1>
<p>Please contact Andreas Hindborg through
<a href="Contact.html#zulip-chat">Zulip</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-binder-driver"><a class="header" href="#android-binder-driver">Android Binder Driver</a></h1>
<p>This project is an effort to rewrite Android's Binder kernel driver in Rust.</p>
<p>The latest version of the Rust implementation can be found in the RFC that was
submitted to the Linux Kernel mailing list on November 1st: <a href="https://lore.kernel.org/rust-for-linux/20231101-rust-binder-v1-0-08ba9197f637@google.com/">Setting up Binder for
the future</a>.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>Binder is one of the most security and performance critical components of Android.
Android isolates apps from each other and the system by assigning each app a
unique user ID (UID).  This is called &quot;application sandboxing&quot;, and is a fundamental
tenet of the <a href="https://arxiv.org/abs/1904.05572">Android Platform Security Model</a>.</p>
<p>The majority of inter-process communication (IPC) on Android goes through Binder.
Thus, memory unsafety vulnerabilities are especially critical when they happen in the
Binder driver.</p>
<h2 id="maintenance"><a class="header" href="#maintenance">Maintenance</a></h2>
<p>The Rust driver was originally authored by Wedson Almeida Filho, and is now maintained
by Alice Ryhl. The ongoing work will be part of the
<a href="https://source.android.com/">Android Open Source Project</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="puzzlefs-filesystem-driver"><a class="header" href="#puzzlefs-filesystem-driver">PuzzleFS filesystem driver</a></h1>
<p><a href="https://github.com/project-machine/puzzlefs">PuzzleFS</a> is a container
filesystem designed to address the limitations of the existing OCI format. The
main goals of the project are reduced duplication, reproducible image builds,
direct mounting support and memory safety guarantees, some inspired by the
<a href="https://hackmd.io/@cyphar/ociv2-brainstorm">OCIv2 design document</a>.</p>
<p>Reduced duplication is achieved using the content defined chunking algorithm
FastCDC. This implementation allows chunks to be shared among layers. Building
a new layer starting from an existing one allows reusing most of the chunks.</p>
<p>Another goal of the project is reproducible image builds, which is achieved by
defining a canonical representation of the image format. Direct mounting
support is a key feature of puzzlefs and, together with fs-verity, it provides
data integrity.</p>
<p>Lastly, memory safety is critical to puzzlefs, leading to the decision to
implement it in Rust. Another goal is to share the same code between user space
and kernel space in order to provide one secure implementation.</p>
<h2 id="resources-2"><a class="header" href="#resources-2">Resources</a></h2>
<ul>
<li><a href="https://github.com/project-machine/puzzlefs">PuzzleFS main repository</a></li>
<li><a href="https://github.com/ariel-miculas/linux/tree/puzzlefs">PuzzleFS kernel branch</a></li>
<li><a href="https://github.com/project-machine/puzzlefs/issues/78">Issue tracking the development of the kernel driver</a></li>
<li><a href="https://osseu2023.sched.com/event/b98e711a56261b4a892b5fdcdc29ca73">Talk at Open Source Summit Europe</a></li>
<li><a href="https://kangrejos.com/2023/PuzzleFS.pdf">Kangrejos slides</a></li>
<li><a href="https://lwn.net/Articles/945320/">LWN article</a></li>
</ul>
<h2 id="maintenance-1"><a class="header" href="#maintenance-1">Maintenance</a></h2>
<p>The PuzzleFS driver is maintained by Ariel Miculas. Contact him at
<a href="mailto:amiculas@cisco.com">amiculas@cisco.com</a> or through
<a href="Contact.html#zulip-chat">Zulip</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apple-agx-gpu-driver"><a class="header" href="#apple-agx-gpu-driver">Apple AGX GPU driver</a></h1>
<p>As part of the <a href="https://asahilinux.org/about/">Asahi Linux</a> project, the Apple
AGX GPU driver has been implemented in Rust for the Linux kernel, along with
creating DRM bindings and associated userspace pieces.</p>
<p>The driver lives <a href="https://github.com/AsahiLinux/linux/tree/bits/210-gpu">here</a>.
The current development team is:</p>
<ul>
<li><a href="https://social.treehouse.systems/@alyssa">Alyssa Rosenzweig</a> is writing
the OpenGL driver and compiler.</li>
<li><a href="https://vt.social/@lina">Asahi Lina</a> is writing the kernel driver and
helping with OpenGL.</li>
<li><a href="https://mastodon.social/@dougall">Dougall Johnson</a> is reverse-engineering
the instruction set with Alyssa.</li>
<li><a href="https://tech.lgbt/@ella">Ella Stanforth</a> is working on a Vulkan driver.</li>
</ul>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ul>
<li><a href="https://asahilinux.org/2022/12/gpu-drivers-now-in-asahi-linux/">Apple GPU drivers now in Asahi Linux</a></li>
<li><a href="https://asahilinux.org/2022/11/tales-of-the-m1-gpu/">Tales of the M1 GPU</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
